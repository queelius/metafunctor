<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://unpkg.com/lunr/lunr.js"></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>treeprog | metafunctor</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Stars: 0 | Forks: 0 | Open Issues: 0
Languages: Python
Contributors

queelius (1 commits)

README
Universal Tree Traversal
Introduction
There are many ways to traverse a tree. The most common ways are:

Pre-order traversal
Post-order traversal
In-order traversal
Level-order traversal

These are the most common ways to traverse a tree, but there are many other
ways to traverse a tree. For example, you can traverse a tree in a spiral
pattern, or you can traverse a tree in a zig-zag pattern. You can also
traverse a tree in a random order. There are many ways to traverse a tree,
and each way has its own advantages and disadvantages. Sometimes, you only
want to traverse a subset of the tree, or you may want to traverse the tree
upwards (parent relationships) instead of downwards (child relationships),
or even sideways (level order via sibling relationships).">
    <meta name="generator" content="Hugo 0.139.2">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    
      <meta name="author" content = "Alex Towell">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]      
    }
  };
</script>
        
    
    
      

    

    

    
      <link rel="canonical" href="http://localhost:1313/projects2/treeprog/">
    

    <meta property="og:url" content="http://localhost:1313/projects2/treeprog/">
  <meta property="og:site_name" content="metafunctor">
  <meta property="og:title" content="treeprog">
  <meta property="og:description" content="Stars: 0 | Forks: 0 | Open Issues: 0
Languages: Python
Contributors queelius (1 commits) README Universal Tree Traversal Introduction There are many ways to traverse a tree. The most common ways are:
Pre-order traversal Post-order traversal In-order traversal Level-order traversal These are the most common ways to traverse a tree, but there are many other ways to traverse a tree. For example, you can traverse a tree in a spiral pattern, or you can traverse a tree in a zig-zag pattern. You can also traverse a tree in a random order. There are many ways to traverse a tree, and each way has its own advantages and disadvantages. Sometimes, you only want to traverse a subset of the tree, or you may want to traverse the tree upwards (parent relationships) instead of downwards (child relationships), or even sideways (level order via sibling relationships).">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="projects2">
    <meta property="article:published_time" content="2024-06-16T03:18:26+00:00">
    <meta property="article:modified_time" content="2024-06-16T03:18:26+00:00">
    <meta property="article:tag" content="GitHub">
    <meta property="article:tag" content="Project">

  <meta itemprop="name" content="treeprog">
  <meta itemprop="description" content="Stars: 0 | Forks: 0 | Open Issues: 0
Languages: Python
Contributors queelius (1 commits) README Universal Tree Traversal Introduction There are many ways to traverse a tree. The most common ways are:
Pre-order traversal Post-order traversal In-order traversal Level-order traversal These are the most common ways to traverse a tree, but there are many other ways to traverse a tree. For example, you can traverse a tree in a spiral pattern, or you can traverse a tree in a zig-zag pattern. You can also traverse a tree in a random order. There are many ways to traverse a tree, and each way has its own advantages and disadvantages. Sometimes, you only want to traverse a subset of the tree, or you may want to traverse the tree upwards (parent relationships) instead of downwards (child relationships), or even sideways (level order via sibling relationships).">
  <meta itemprop="datePublished" content="2024-06-16T03:18:26+00:00">
  <meta itemprop="dateModified" content="2024-06-16T03:18:26+00:00">
  <meta itemprop="wordCount" content="1422">
  <meta itemprop="keywords" content="GitHub,Project">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="treeprog">
  <meta name="twitter:description" content="Stars: 0 | Forks: 0 | Open Issues: 0
Languages: Python
Contributors queelius (1 commits) README Universal Tree Traversal Introduction There are many ways to traverse a tree. The most common ways are:
Pre-order traversal Post-order traversal In-order traversal Level-order traversal These are the most common ways to traverse a tree, but there are many other ways to traverse a tree. For example, you can traverse a tree in a spiral pattern, or you can traverse a tree in a zig-zag pattern. You can also traverse a tree in a random order. There are many ways to traverse a tree, and each way has its own advantages and disadvantages. Sometimes, you only want to traverse a subset of the tree, or you may want to traverse the tree upwards (parent relationships) instead of downwards (child relationships), or even sideways (level order via sibling relationships).">

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        metafunctor
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/social/" title="Social page">
              Social
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About Me page">
              About Me
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/ghprojects/" title="GitHub Projects page">
              GitHub Projects
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="News page">
              News
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/probsets/" title="Problem Sets page">
              Problem Sets
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/projects2/" title="Projects page">
              Projects
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/publications/" title="Publications page">
              Publications
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/research/" title="Research projects page">
              Research projects
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/search/" title="Search page">
              Search
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Projects
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">treeprog</h1>
      
      <p class="tracked">
        By <strong>Alex Towell</strong>
      </p>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2024-06-16T03:18:26Z">June 16, 2024</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><strong>Stars</strong>: 0 | <strong>Forks</strong>: 0 | <strong>Open Issues</strong>: 0</p>
<p><strong>Languages</strong>: Python</p>
<h2 id="contributors">Contributors</h2>
<ul>
<li>queelius (1 commits)</li>
</ul>
<h2 id="readme">README</h2>
<h1 id="universal-tree-traversal"><code>Universal Tree Traversal</code></h1>
<h2 id="introduction">Introduction</h2>
<p>There are many ways to traverse a tree. The most common ways are:</p>
<ul>
<li>Pre-order traversal</li>
<li>Post-order traversal</li>
<li>In-order traversal</li>
<li>Level-order traversal</li>
</ul>
<p>These are the most common ways to traverse a tree, but there are many other
ways to traverse a tree. For example, you can traverse a tree in a spiral
pattern, or you can traverse a tree in a zig-zag pattern. You can also
traverse a tree in a random order. There are many ways to traverse a tree,
and each way has its own advantages and disadvantages. Sometimes, you only
want to traverse a subset of the tree, or you may want to traverse the tree
upwards (parent relationships) instead of downwards (child relationships),
or even sideways (level order via sibling relationships).</p>
<h2 id="universal-tree-traversal-1">Universal Tree Traversal</h2>
<p>Universal tree traversal is a domain-specific language (DSL) that
allows some order of traversal to be described and executed in the context of
its tree context. The DSL is intentionally limited in scope to tree traversal
orders, but it is flexible enough to describe most meaningful tree traversals.</p>
<h3 id="computational-model">Computational Model</h3>
<p>The computational model which evaluates the DSL is not Turing complete. It is
not a general-purpose programming language, but rather a DSL for describing tree
traversal orders. We say that it is a Universal Tree Traversal (UTT) because it
can describe most meaningful tree traversal orders with a facility for
conditional traversal, payload transformation, and result collection and
aggregation.</p>
<p>The DSL is a declarative langauge that takes care of the details of
tree traversal for you. Because of this, a general stack-based model is
not necessary. Instead, the DSL is a list of actions applied to tree nodes
in some order as described by the actions. There is state that is maintained
in the form of a local environment for each node that situates it in the
context of the tree, but this state is not a general-purpose stack-based
model.</p>
<h4 id="environment-model">Environment Model</h4>
<p>The environment model represents the context of a node in its tree. We populate
the node&rsquo;s local environment with some special values that represent the node
other relationships it has to other nodes in the tree.</p>
<p>To reference an environment variable, we use the <code>$</code> symbol followed by the
name of the variable. For example, <code>$node</code> is the node that the traversal
order is currently being applied to. You can store values in the environment
with the <code>set!</code> action:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;set!&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;value&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>When you set a value in the environment, you can reference it later in the<br>
traversal order. Any nodes that follow this node (see <code>follow</code> action) will
be able to access these environment variables, which allows you to pass values
from one node to another in the traversal order.</p>
<p>These enviroment variables may be used as arguments to predicates that describe
the traversal order. When we arrive at a node, we also populate the environment
with some special values that represent the node and its relationships to other
nodes in the tree. These values are:</p>
<ul>
<li><code>$node</code> is the node that the traversal order is being applied to.</li>
<li><code>$depth</code> is the depth of the node in the tree.</li>
<li><code>$num_children</code> is the number of children of the node.</li>
<li><code>$parent</code> is the parent of the node.</li>
<li><code>$sibling</code> is the sibling of the node.</li>
<li><code>$root</code> is the root of the tree.</li>
<li><code>$tree</code> is the tree that the node is in.</li>
<li><code>$results</code> is a global dictionary of results that the nodes are added to. The
results are keyed by the value of the <code>result-name</code> argument in the <code>visit</code>
action.</li>
</ul>
<h3 id="traversal-order-grammar">Traversal Order Grammar</h3>
<p>The traversal order grammar defines a JSON array of dictionaries that describe
a conditional seuence of actions that are applied to a node in the tree. The
actions are applied in order, which defines the traversal order of the tree.</p>
<p>The traversal order description is given by the following BNF:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bnf" data-lang="bnf"><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">order</span>&gt;         <span style="color:#f92672">::=</span> &#34;[&#34; &#34;]&#34; | &#34;[&#34; &lt;<span style="color:#a6e22e">action</span>&gt; (&#34;,&#34; &lt;<span style="color:#a6e22e">action</span>&gt;)* &#34;]&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">action</span>&gt;        <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">visit</span>&gt; | &lt;<span style="color:#a6e22e">payload</span>&gt; | &lt;<span style="color:#a6e22e">cond</span>&gt; | &lt;<span style="color:#a6e22e">follow</span>&gt; | &lt;<span style="color:#a6e22e">set</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">set</span>&gt;           <span style="color:#f92672">::=</span> &#34;{&#34;
</span></span><span style="display:flex;"><span>                        &#34;\&#34;set!\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">kwargs</span>&gt;
</span></span><span style="display:flex;"><span>                    &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">follow</span>&gt;        <span style="color:#f92672">::=</span> &#34;{&#34;
</span></span><span style="display:flex;"><span>                        &#34;\&#34;follow\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">dir</span>&gt; 
</span></span><span style="display:flex;"><span>                        (&#34;,&#34; &#34;\&#34;select\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">select</span>&gt;)? 
</span></span><span style="display:flex;"><span>                        (&#34;,&#34; &#34;\&#34;select-order\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">select_order</span>&gt;)?
</span></span><span style="display:flex;"><span>                    &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">visit</span>&gt;         <span style="color:#f92672">::=</span> &#34;{&#34;
</span></span><span style="display:flex;"><span>                        &#34;\&#34;visit\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">pred_fn</span>&gt; 
</span></span><span style="display:flex;"><span>                        (&#34;,&#34; &#34;\&#34;result-name\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">key</span>&gt;)? 
</span></span><span style="display:flex;"><span>                        (&lt;<span style="color:#a6e22e">args</span>&gt;)? 
</span></span><span style="display:flex;"><span>                    &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">cond</span>&gt;          <span style="color:#f92672">::=</span> &#34;{&#34;
</span></span><span style="display:flex;"><span>                        &#34;\&#34;cond\&#34;&#34; &#34;:&#34; &#34;[&#34;
</span></span><span style="display:flex;"><span>                            &lt;<span style="color:#a6e22e">cond_case</span>&gt;
</span></span><span style="display:flex;"><span>                            (&#34;,&#34; &lt;<span style="color:#a6e22e">cond_case</span>&gt;)*
</span></span><span style="display:flex;"><span>                        &#34;]&#34;
</span></span><span style="display:flex;"><span>                    &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">cond_case</span>&gt;     <span style="color:#f92672">::=</span> &#34;{&#34;
</span></span><span style="display:flex;"><span>                        &#34;\&#34;pred\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">pred_fn</span>&gt;
</span></span><span style="display:flex;"><span>                        (&#34;,&#34; &lt;<span style="color:#a6e22e">args</span>&gt;)? &#34;,&#34;
</span></span><span style="display:flex;"><span>                        &#34;\&#34;order\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">order</span>&gt;
</span></span><span style="display:flex;"><span>                    &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">payload</span>&gt;       <span style="color:#f92672">::=</span> &#34;{&#34;
</span></span><span style="display:flex;"><span>                        &#34;\&#34;payload-map\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">payload_fn</span>&gt;
</span></span><span style="display:flex;"><span>                        (&#34;,&#34; &lt;<span style="color:#a6e22e">args</span>&gt;)?
</span></span><span style="display:flex;"><span>                    &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">args</span>&gt;          <span style="color:#f92672">::=</span> &#34;\&#34;args\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">posargs</span>&gt; | &#34;\&#34;kwargs\&#34;&#34; &#34;:&#34; &lt;<span style="color:#a6e22e">kwargs</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">posargs</span>&gt;       <span style="color:#f92672">::=</span> &#34;[&#34; &#34;]&#34; | &#34;[&#34; &lt;<span style="color:#a6e22e">arg</span>&gt; (&#34;,&#34; &lt;<span style="color:#a6e22e">arg</span>&gt;)* &#34;]&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">arg</span>&gt;           <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">value</span>&gt; | &lt;<span style="color:#a6e22e">env_var</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">kwargs</span>&gt;        <span style="color:#f92672">::=</span> &#34;{&#34; &#34;}&#34; | &#34;{&#34; &lt;<span style="color:#a6e22e">kwarg</span>&gt; (&#34;,&#34; &lt;<span style="color:#a6e22e">kwarg</span>&gt;)* &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">kwarg</span>&gt;         <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">key</span>&gt; &#34;:&#34; &lt;<span style="color:#a6e22e">arg</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">env_var</span>&gt;       <span style="color:#f92672">::=</span> &#34;$&#34; &lt;<span style="color:#a6e22e">key</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">pred_fn</span>&gt;       <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">boolean</span>&gt; | &#34;\&#34;less?\&#34;&#34; | &#34;\&#34;eq?\&#34;&#34; | &lt;<span style="color:#a6e22e">key</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">selector</span>&gt;      <span style="color:#f92672">::=</span> &#34;\&#34;all\&#34;&#34; | &#34;\&#34;none\&#34;&#34; | &#34;\&#34;rest\&#34;&#34; | &#34;\&#34;rand\&#34;&#34; | &lt;<span style="color:#a6e22e">key</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">select_order</span>&gt;  <span style="color:#f92672">::=</span> &#34;\&#34;id\&#34;&#34; | &#34;\&#34;reverse\&#34;&#34; | &#34;\&#34;shuffle\&#34;&#34; | &lt;<span style="color:#a6e22e">key</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">dir</span>&gt;           <span style="color:#f92672">::=</span> &#34;\&#34;up\&#34;&#34; | &#34;\&#34;down\&#34;&#34;  | &#34;\&#34;sideways\&#34;&#34; | &lt;<span style="color:#a6e22e">key</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">payload_fn</span>&gt;    <span style="color:#f92672">::=</span> &#34;\&#34;id\&#34;&#34; | &#34;\&#34;proj\&#34;&#34; | &#34;\&#34;rename\&#34;&#34; | &lt;<span style="color:#a6e22e">key</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">key</span>&gt;           <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">str</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">value</span>&gt;         <span style="color:#f92672">::=</span> &#34;{}&#34; | &lt;<span style="color:#a6e22e">str</span>&gt; | &lt;<span style="color:#a6e22e">int</span>&gt; | &lt;<span style="color:#a6e22e">float</span>&gt; | &lt;<span style="color:#a6e22e">boolean</span>&gt;
</span></span><span style="display:flex;"><span>                | &#34;[&#34; &lt;<span style="color:#a6e22e">value</span>&gt; (&#34;,&#34; &lt;<span style="color:#a6e22e">value</span>&gt;)* &#34;]&#34; 
</span></span><span style="display:flex;"><span>                | &#34;{&#34; &lt;<span style="color:#a6e22e">key</span>&gt; &#34;:&#34; &lt;<span style="color:#a6e22e">value</span>&gt; (&#34;,&#34; &lt;<span style="color:#a6e22e">key</span>&gt; &#34;:&#34; &lt;<span style="color:#a6e22e">value</span>&gt;)* &#34;}&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">str</span>&gt;           <span style="color:#f92672">::=</span> &#34;\&#34;&#34; &lt;<span style="color:#a6e22e">char</span>&gt;+ &#34;\&#34;&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">int</span>&gt;           <span style="color:#f92672">::=</span> (&#34;-&#34;)? &lt;<span style="color:#a6e22e">digit</span>&gt;+
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">float</span>&gt;         <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">int</span>&gt; &#34;.&#34; &lt;<span style="color:#a6e22e">digit</span>&gt;+
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">boolean</span>&gt;       <span style="color:#f92672">::=</span> &#34;true&#34; | &#34;false&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">char</span>&gt;          <span style="color:#f92672">::=</span> &lt;<span style="color:#a6e22e">letter</span>&gt; | &lt;<span style="color:#a6e22e">digit</span>&gt; | &#34;-&#34; | &#34;_&#34; | &#34;.&#34; | &#34;?&#34; | &#34;!&#34;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">letter</span>&gt;        <span style="color:#f92672">::=</span> [a-z] | [A-Z]
</span></span><span style="display:flex;"><span>&lt;<span style="color:#a6e22e">digit</span>&gt;         <span style="color:#f92672">::=</span> [0-9]
</span></span></code></pre></div><p>A traversal order is a list of actions that are applied to a node in the tree.
The actions are applied in order. The actions are defined in the <code>action</code>
production. The <code>action</code> production is a dictionary with the following keys:</p>
<ul>
<li><code>order</code> is a list of actions that are applied to a node in the tree.</li>
<li><code>visit</code> is an action predicate &ndash; if the node satisfies the predicate,
the node is added to a result list.</li>
<li><code>payload-map</code> is a function that maps the node to a new payload for
the node. This payload map should not change the tree structure, only
the payload of the node.</li>
<li><code>cond</code> is a conditional traversal &ndash; if the node satisfies the predicate,
the traversal order it is associated with is applied.</li>
<li><code>follow</code> is the direction of traversal: <code>up</code>, <code>down</code>, <code>sideways</code> (level order),
or any other direction that is defined in the <code>follow</code> dispatch table.</li>
<li><code>select</code> is a selector that determines which nodes are selected for
traversal. <code>all</code> selects all nodes, <code>none</code> selects no nodes, <code>rest</code>
selects all nodes not previously selected, and any other selector that
is defined in the <code>selector</code> dispatch table.</li>
<li><code>select-order</code> is the order in which the selected nodes are traversed.
<code>identity</code> traverses the nodes in the order they were selected, <code>reverse</code>
traverses the nodes in reverse order, <code>shuffle</code> traverses the nodes in a
random order, and any other order that is defined in the <code>select-order</code>
dispatch table.</li>
</ul>
<p>The <code>args</code> and <code>kwargs</code> keys are used to pass arguments to the action predicates.</p>
<p>Some special environment variables that are automatically added to the
environment of the node are:</p>
<ul>
<li><code>$node</code> is the node that the traversal order is being applied to.</li>
<li><code>$depth</code> is the depth of the node in the tree.</li>
<li><code>$num_children</code> is the number of children of the node.</li>
<li><code>$parent</code> is the parent of the node.</li>
<li><code>$root</code> is the root of the tree.</li>
<li><code>$results</code> is a global dictionary of results that the nodes are added to. The
results are keyed by the value of the <code>result-name</code> argument in the <code>visit</code>
action.</li>
</ul>
<h2 id="examples">Examples</h2>
<p>Here is a simple pre-order traversal of all nodes in the tree:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[ { <span style="color:#f92672">&#34;visit&#34;</span>: <span style="color:#e6db74">&#34;true&#34;</span>, <span style="color:#f92672">&#34;result-name&#34;</span>: <span style="color:#e6db74">&#34;pre-order&#34;</span> }, { <span style="color:#f92672">&#34;follow&#34;</span>: <span style="color:#e6db74">&#34;down&#34;</span> } ]
</span></span></code></pre></div><p>If we wanted to only go to a depth of up to 2, we could use a conditional
traversal:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[ { <span style="color:#f92672">&#34;cond&#34;</span>: [
</span></span><span style="display:flex;"><span>    { <span style="color:#f92672">&#34;pred&#34;</span> : <span style="color:#e6db74">&#34;less?&#34;</span>, <span style="color:#f92672">&#34;args&#34;</span> : [<span style="color:#e6db74">&#34;$depth&#34;</span>, <span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;order&#34;</span> : [ { <span style="color:#f92672">&#34;visit&#34;</span>: <span style="color:#e6db74">&#34;true&#34;</span>, <span style="color:#f92672">&#34;result-name&#34;</span>: <span style="color:#e6db74">&#34;pre-order&#34;</span>},
</span></span><span style="display:flex;"><span>                  { <span style="color:#f92672">&#34;follow&#34;</span>: <span style="color:#e6db74">&#34;down&#34;</span> } ]} ]} ]
</span></span></code></pre></div><p>Suppose we want to update the payloads to include a count of the number of
ancestors of the node. We can use a payload map to do this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[ { <span style="color:#f92672">&#34;visit&#34;</span>: <span style="color:#e6db74">&#34;true&#34;</span>, <span style="color:#f92672">&#34;result-name&#34;</span>: <span style="color:#66d9ef">null</span> },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;payload-map&#34;</span>: <span style="color:#e6db74">&#34;num-ancestors&#34;</span>, <span style="color:#f92672">&#34;args&#34;</span>: [<span style="color:#e6db74">&#34;$node&#34;</span>] } ]
</span></span></code></pre></div><p>We see that specifying a <code>null</code> result name means that the node is not added
to the results list. This is useful when you want to update the payload of
the node without adding it to the results.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>[ { <span style="color:#f92672">&#34;visit&#34;</span>: <span style="color:#e6db74">&#34;is-leaf?&#34;</span> },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;payload-map&#34;</span>: <span style="color:#e6db74">&#34;node-stats&#34;</span>, <span style="color:#f92672">&#34;args&#34;</span>: [<span style="color:#e6db74">&#34;$node&#34;</span>] },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;follow&#34;</span>: <span style="color:#e6db74">&#34;down&#34;</span>, <span style="color:#f92672">&#34;select&#34;</span>: <span style="color:#e6db74">&#34;slice&#34;</span>, <span style="color:#f92672">&#34;args&#34;</span>: [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">-1</span>] } ]
</span></span></code></pre></div><ul class="pa0">
  
   <li class="list di">
     <a href="/tags/github/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">GitHub</a>
   </li>
  
   <li class="list di">
     <a href="/tags/project/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Project</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
        <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "metafunctor-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/ghprojects/treeprog/">treeprog</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/ghprojects/random_oracles/">random_oracles</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/projects2/random_oracles/">random_oracles</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/projects2/ollama_data_tools/">ollama_data_tools</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/ghprojects/ollama_data_tools/">ollama_data_tools</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/projects2/algotree/">AlgoTree</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/ghprojects/algotree/">AlgoTree</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/projects2/hypothesize/">hypothesize</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/ghprojects/hypothesize/">hypothesize</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/ghprojects/solomonoff_induction/">solomonoff_induction</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/projects2/solomonoff_induction/">solomonoff_induction</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/ghprojects/sluug-talk-llm/">sluug-talk-llm</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/projects2/sluug-talk-llm/">sluug-talk-llm</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/projects2/elasticsearch-lm/">elasticsearch-lm</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/ghprojects/elasticsearch-lm/">elasticsearch-lm</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:1313/" >
    &copy;  metafunctor 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
